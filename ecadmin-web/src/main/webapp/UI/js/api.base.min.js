if(typeof Base==="undefined"){var Base={}}Base.clone=function(b){if(typeof b=="object"){var c=new Object();for(var a in b){c[a]=b[a]}return c}else{return b}};Base.countDownTime=function(i,h,c){var d=h||60;var g="";var e=["00","01","02","03","04","05","06","07","08","09"];var b=$("<span class='count-time'>"+d+"</span>");var a;i.empty().append(b);function f(){d=d-1;var j=d;if(d<10){j=e[j]}b.html(j);if(j=="00"&&c){clearInterval(a);c()}}a=setInterval(f,1000)};Base.trim=function(a){if(String.prototype.trim){return a==null?"":String.prototype.trim.call(a)}else{return a.replace(/(^\s*)|(\s*$)/g,"")}};Base.trimAll=function(a){return a.replace(/\s*/g,"")};Base.isElement=function(a){return !!(a&&a.nodeType==1)};Base.isArray=function(a){if(Array.isArray){return Array.isArray(a)}else{return a instanceof Array}};Base.isFunction=function(a){return Object.prototype.toString.call(a)==="[object Function]"};Base.isString=function(a){return Object.prototype.toString.call(a)==="[object String]"};Base.isObject=function(a){return Object.prototype.toString.call(a)==="[object Object]"};Base.isEmptyObject=function(a){if(JSON.stringify(a)==="{}"){return true}return false};Base.isWindow=function(a){return a!=null&&a==a.window};Base.isPlainObject=function(a){return m.isObject(a)&&!m.isWindow(a)&&Object.getPrototypeOf(a)==Object.prototype};Base.objToJsonStr=Base.jsonToStr=function(c){if(c==null||c=="undefined"){return null}var b=[];if(typeof c=="string"){return c}if(typeof c=="object"){if(!jQuery.isArray(c)){for(var a in c){if(typeof c[a]=="string"||typeof c[a]=="number"){if(c[a]!=undefined){b.push('"'+a+'":"'+c[a].toString().replace(/\"/g,'\\"')+'"')}else{b.push('"'+a+'":null')}}else{b.push('"'+a+'":'+Base.jsonToStr(c[a]))}}if(!!document.all&&!/^\n?function\s*toString\(\)\s*\{\n?\s*\[native code\]\n?\s*\}\n?\s*$/.test(c.toString)){b.push("toString:"+c.toString.toString())}b="{"+b.join()+"}"}else{for(var a=0;a<c.length;a++){b.push(Base.jsonToStr(c[a]))}b="["+b.join()+"]"}return b}return c.toString()};Base.strToJson=function(str){if(str==null||str=="undefined"){return null}if(Base.isString(str)){return eval("("+str+")")}else{return str}};Base.isExist=function(a){return(typeof a!="undefined")&&(a!=null)&&(a!="")};Base.isMobilePhone=function(a){return/^1[3|4|5|8][0-9]\d{8}$/.test(a)};Base.isInteger=function(a){return/^[1-9]\d*$/.test(a)};Base.formatMoney=function(a,c){var c=c||2;if(typeof a!="number"){a=Number(a)}var b=Math.pow(10,c);a=(Math.ceil(a*b))/b;return a.toFixed(c)};Base.isIntegerConZero=function(a){return/^[1-9]\d*|0$/.test(a)};Base.showMask=function(){var a=$(window).height();var d=$(window).width();var e=$('<div class="gm-mask"></div>');var b=$("<div class='gm-wrap'></div>");var c=$('<span class="gm-gif"><i class="fa fa-spinner fa-spin"></i> 请稍后...</span>');e.width(d);e.height(a);b.width(d);b.height(a);c.css("margin-top",a/2+"px");b.append(c);$("body").append(e).append(b)};Base.removeMask=function(){$(".gm-mask").remove();$(".gm-wrap").remove()};Base.cookie=new function(){this.add=function(c,e,a){var d=new Date().getTime();d=a*1000*60*60;var b=c+"="+escape(e)+";Path=/;expires="+new Date(new Date().getTime()+d).toGMTString();document.cookie=b};this.get=function(b){var e=document.cookie.split(";");if(e.length>0){for(var d in e){var a=e[d];var c=a.split("=");if(Base.trim(c[0])==b){return unescape(c[1])}if(d==e.length-1){return null}}}};this.remove=function(b){var a=b+"="+escape("null")+";Path=/;expires="+new Date().toGMTString();document.cookie=a}};if(typeof layer=="undefined"){throw"api.base.js 依赖layer弹框组建,请添加引用."}Base.ajax=function(h){var f=h;var i=f["mask"];var c;if(i===undefined){c=layer.load()}else{if(i){c=layer.load()}}var a=f["data"];if(!a){a=new Object()}f["data"]=a;if(!f.dataType){f.dataType="json"}if(!f.type){f.type="post"}var d=f["beforeSend"];f["beforeSend"]=d?function(k,j){d(k,j)}:function(k,j){};var e=f["success"];f["success"]=e?function(k,j,l){Base._dealdata(k);e(k,j,l)}:function(k,j,l){Base._dealdata(k)};var g=f["error"];f["error"]=g?function(l,k,j){g(l,k,j)}:function(l,k,j){if(l.status==404){Base.alert("请求的地址没有找到")}};var b=f["complete"];f["complete"]=b?function(k,j){if(c){layer.close(c)}b(k,j)}:function(k,j){if(c){layer.close(c)}};$.ajax(f)};Base._dealdata=function(c){if(typeof c!="object"){return}if(c){if(c.error){if(c.error_msg){layer.msg(c.error_msg,{icon:2})}}else{if(c.success_msg){layer.msg(c.success_msg,{icon:1})}}if(c.tipMsg){Base.alert(c.tipMsg)}if(c.focus){Base.focus(c.focus)}if(c.lists){var a=c.lists;for(var b in a){Base.setDatagridData(b,a[b])}}}};Base.alert=function(a){var b="info";var c="";if(Base.isObject(a)){b=a.type?a.type:"info";c=a.message?a.message:"info"}else{if(Base.isString(a)){c=a}else{return false}}layer.msg(c)};Base.tips=function(d,a,c,b){c=c||3000;b=b||"#ed5565";layer.tips(d,a,{tips:[1,b],time:c})};Base.openIframe=function(a){if(!a){return}if($.type(a)!="object"||!$.isPlainObject(a)){return}var b=a;delete a;return layer.open({type:2,shift:0,title:b.title,maxmin:true,area:[b.width,b.height],content:b.href,end:b.afterClose||null})};Base.closeIframe=function(a){if(a){layer.close(a)}};Base.confirm=function(b,c){var a={};a.title="确认提示";a.message=b?b:"";layer.confirm(a.message,{btn:["确认","取消"]},function(){if(c){c(true)}},function(){if(c){c(false)}})};Base.focus=function(b){var a=document.getElementById(b);if(a){$(a).focus()}else{a=$(":input[name="+b+"]");if(a){a.focus()}}};var CommonFormatter={format:function(b,c,a){return moment(b).format("YYYY-MM-DD HH:mm:ss")}};Base.loadGridData=function(b,a,f){if(typeof b!="string"){return}var e="";var d={};if(a){e=$("#"+a).serializeArray();for(var c=0;c<e.length;c++){d[e[c].name]=e[c].value}}if(f){d=$.extend({},d,f)}$("#"+b).datagrid("load",d)};Base.reloadGridData=function(a){if(typeof a!="string"){return}$("#"+a).datagrid("reload")};Base.queryEcGrid=function(c,b,a,g){if(typeof c!="string"){return}if(typeof b!="string"){return}c=(c.indexOf("?")==-1?(c+"?_r="+Math.random()):(c+"&_r="+Math.random()));var f="";var e={};if(a){f=$("#"+a).serializeArray();for(var d=0;d<f.length;d++){e[f[d].name]=f[d].value}}if(g){e=$.extend({},e,g)}$("#"+b).datagrid({url:c,queryParams:e})};Base.updateDatagridRow=function(a,b,c){if(typeof a!="string"){return}if(typeof c=="string"){return}if(typeof b=="undefined"){return}if(typeof b!="number"){b=Number(b)}$("#"+a).datagrid("updateRow",{index:b,row:c})};Base.appendDatagridRow=function(b,f){if(typeof b!="string"){return}if(typeof f=="string"){return}$("#"+b).datagrid("appendRow",f);var a=$("#"+b).datagrid("getColumnFields");for(var d=0;d<a.length;d++){var e=a[d];var c=$("#"+b).datagrid("getColumnOption",e);if(c.editor&&c.editor.type){if(Base.endDatagridEditing(b)){Base.acceptDatagridChanges(b);___editIndex=$("#"+b).datagrid("getRows").length-1;$("#"+b).datagrid("selectRow",___editIndex).datagrid("beginEdit",___editIndex)}break}}};Base.insertDatagridRow=function(b,d,g){if(typeof b!="string"){return}if(typeof g=="string"){return}if(typeof d=="undefined"){return}if(typeof d!="number"){d=Number(d)}$("#"+b).datagrid("insertRow",{index:d,row:g});var a=$("#"+b).datagrid("getColumnFields");for(var e=0;e<a.length;e++){var f=a[e];var c=$("#"+b).datagrid("getColumnOption",f);if(c.editor&&c.editor.type){if(Base.endDatagridEditing(b)){Base.acceptDatagridChanges(b);___editIndex=d;$("#"+b).datagrid("selectRow",___editIndex).datagrid("beginEdit",___editIndex)}break}}};Base.deleteDatagridRow=function(a,b){if(typeof a!="string"){return}if(typeof b=="undefined"){return}if(typeof b!="number"){b=Number(b)}if(___editIndex!=undefined&&___editIndex==b){$("#"+a).datagrid("cancelEdit",b);___editIndex=undefined}$("#"+a).datagrid("deleteRow",b)};Base.deleteDatagridRows=function(a,d){if(typeof a!="string"){return}if(typeof d!="object"){return}for(var c in d){var b=Base.getDatagridRowIndex(a,d[c]);Base.deleteDatagridRow(a,b)}};Base.getDatagridRowIndex=function(a,b){if(typeof a!="string"){return}if(typeof b=="undefined"){return}return $("#"+a).datagrid("getRowIndex",b)};Base.getDatagridChanges=function(a,b){if(typeof a!="string"){return}if(typeof b!="string"){b=undefined}if(Base.endDatagridEditing(a)){return $("#"+a).datagrid("getChanges",b)}return[]};Base.acceptDatagridChanges=function(a){if(typeof a!="string"){return}if(Base.endDatagridEditing(a)){$("#"+a).datagrid("acceptChanges");Base.rejectDatagridChanges(a)}};Base.rejectDatagridChanges=function(a){if(typeof a!="string"){return}$("#"+a).datagrid("rejectChanges");___editIndex=undefined};Base.getDatagridRow=function(a,b){if(typeof a!="string"){return}if(typeof b=="undefined"){return}if(typeof b!="number"){b=Number(b)}var c=$("#"+a).datagrid("getRows");return c[b]};Base.getDatagridAllRows=function(a){if(typeof a!="string"){return}return $("#"+a).datagrid("getData")};Base.getDatagridFooterRows=function(a){if(typeof a!="string"){return}return $("#"+a).datagrid("getFooterRows")};Base.resizeDatagrid=function(a){if(typeof a!="string"){return}$("#"+a).datagrid("resize")};Base.setDatagridData=function(a,b){if(typeof a!="string"){return}if(b.list){b.rows=b.list}$("#"+a).datagrid("loadData",b)};Base.getDatagridSelected=function(a){if(typeof a!="string"){return}return $("#"+a).datagrid("getSelected")};Base.getDatagridSelections=function(a){if(typeof a!="string"){return}return $("#"+a).datagrid("getSelections")};Base.clearDatagridSelections=function(a){if(typeof a!="string"){return}return $("#"+a).datagrid("clearSelections")};Base.scrollToDatagridRow=function(a,b){if(typeof a!="string"){return}if(typeof b=="undefined"){return}if(typeof b!="number"){b=Number(b)}$("#"+a).datagrid("scrollTo",b)};Base.highlightDatagridRow=function(a,b){if(typeof a!="string"){return}if(typeof b=="undefined"){return}if(typeof b!="number"){b=Number(b)}$("#"+a).datagrid("highlightRow",b)};Base.checkAllDatagridRows=function(a){if(typeof a!="string"){return}$("#"+a).datagrid("checkAll")};Base.uncheckAllDatagridRows=function(a){if(typeof a!="string"){return}$("#"+a).datagrid("uncheckAll")};Base.checkDatagridRow=function(a,b){if(typeof a!="string"){return}if(typeof b=="undefined"){return}if(typeof b!="number"){b=Number(b)}$("#"+a).datagrid("checkRow",b)};Base.uncheckDatagridRow=function(a,b){if(typeof a!="string"){return}if(typeof b=="undefined"){return}if(typeof b!="number"){b=Number(b)}$("#"+a).datagrid("uncheckRow",b)};Base.mergeDatagridCells=function(a,b){if(typeof a!="string"){return}if(typeof b!="object"){return}$("#"+a).datagrid("mergeCells",{index:b.index,field:b.field,rowspan:b.rowspan,colspan:b.colspan})};Base.showDatagridColumn=function(a,b){if(typeof a!="string"){return}if(typeof b!="string"){return}$("#"+a).datagrid("showColumn",b)};Base.hideDatagridColumn=function(a,b){if(typeof a!="string"){return}if(typeof b!="string"){return}$("#"+a).datagrid("hideColumn",b)};Base.disableEcTab=function(b,a){if(typeof b!="string"){return}if(typeof a!="string"){return}$("#"+b).tabs("disableTab",a)};Base.enableEcTab=function(b,a){if(typeof b!="string"){return}if(typeof a!="string"){return}$("#"+b).tabs("enableTab",a)};Base.selectEcTab=function(b,a){if(typeof b!="string"){return}if(typeof a!="string"){return}$("#"+b).tabs("select",a)};Base.getEcTreeChecked=function(b,a){if(typeof b!="string"){return}return $("#"+b).tree("getChecked",a)};Base.getEcComboTreeSelected=function(b){if(typeof b!="string"){return}var a=$("#"+b).combotree("tree");return a.tree("getSelected")};Base.getEcComboTreeChecked=function(c,b){if(typeof c!="string"){return}var a=$("#"+c).combotree("tree");if(b){return a.tree("getChecked",b)}else{return a.tree("getChecked")}};Base.getEcComboTreeValues=function(a){if(typeof a!="string"){return}return $("#"+a).combotree("getValues")};Base.getEcComboTreeValue=function(a){if(typeof a!="string"){return}return $("#"+a).combotree("getValue")};Base.getEcComboTreeText=function(a){if(typeof a!="string"){return}return $("#"+a).combotree("textbox").val()};Base.setEcComboTreeValue=function(b,a){if(typeof b!="string"){return}if(a){$("#"+b).combotree("setValue",a)}};Base.setEcComboTreeValues=function(b,a){if(typeof b!="string"){return}if(a){$("#"+b).combotree("setValues",a)}};